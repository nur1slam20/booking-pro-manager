# üß™ –ö–∞–∫ —Å–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –æ—Ç–∑—ã–≤—ã –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ñ—É–Ω–∫—Ü–∏–π

## –ü—Ä–æ–±–ª–µ–º–∞:
–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/reviews` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "0 –æ—Ç–∑—ã–≤–æ–≤" - –ø–æ—ç—Ç–æ–º—É –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–µ –≤–∏–¥–Ω—ã.

## –†–µ—à–µ–Ω–∏–µ: –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –æ—Ç–∑—ã–≤—ã

### –°–ø–æ—Å–æ–± 1: –ß–µ—Ä–µ–∑ UI (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

1. **–°–æ–∑–¥–∞–π –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ:**
   - –ó–∞–π–¥–∏ –Ω–∞ `/bookings`
   - –°–æ–∑–¥–∞–π –Ω–æ–≤–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–≤—ã–±–µ—Ä–∏ —É—Å–ª—É–≥—É, –º–∞—Å—Ç–µ—Ä–∞, –¥–∞—Ç—É, –≤—Ä–µ–º—è)
   - –°–æ—Ö—Ä–∞–Ω–∏

2. **–ó–∞–≤–µ—Ä—à–∏ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–∫–∞–∫ –∞–¥–º–∏–Ω):**
   - –í–æ–π–¥–∏ –∫–∞–∫ –∞–¥–º–∏–Ω (`admin@example.com` / `admin123456`)
   - –ó–∞–π–¥–∏ –Ω–∞ `/admin/bookings`
   - –ù–∞–π–¥–∏ —Å–æ–∑–¥–∞–Ω–Ω–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
   - –ò–∑–º–µ–Ω–∏ —Å—Ç–∞—Ç—É—Å –Ω–∞ `completed` (–ó–∞–≤–µ—Ä—à–∏—Ç—å)

3. **–û—Å—Ç–∞–≤—å –æ—Ç–∑—ã–≤:**
   - –í–µ—Ä–Ω–∏—Å—å –Ω–∞ `/reviews`
   - –£–≤–∏–¥–∏—à—å "–ó–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –±–µ–∑ –æ—Ç–∑—ã–≤–∞"
   - –ö–ª–∏–∫–Ω–∏ "–û—Å—Ç–∞–≤–∏—Ç—å –æ—Ç–∑—ã–≤"
   - –ó–∞–ø–æ–ª–Ω–∏ —Ñ–æ—Ä–º—É –∏ –æ—Ç–ø—Ä–∞–≤—å

4. **–¢–µ–ø–µ—Ä—å —É–≤–∏–¥–∏—à—å:**
   - –û—Ç–∑—ã–≤ –≤ —Å–ø–∏—Å–∫–µ
   - –ü–µ—Ä–µ–∫–ª—é—á–∏—Å—å –Ω–∞ "–í—Å–µ –æ—Ç–∑—ã–≤—ã" - —É–≤–∏–¥–∏—à—å –∫–Ω–æ–ø–∫–∏ üëç/üëé
   - –ê–¥–º–∏–Ω –º–æ–∂–µ—Ç –¥–æ–±–∞–≤–∏—Ç—å –æ—Ç–≤–µ—Ç

---

### –°–ø–æ—Å–æ–± 2: –ß–µ—Ä–µ–∑ SQL (–±—ã—Å—Ç—Ä–æ)

–ï—Å–ª–∏ —Ö–æ—á–µ—à—å –±—ã—Å—Ç—Ä–æ —Å–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–µ –æ—Ç–∑—ã–≤—ã, –≤—ã–ø–æ–ª–Ω–∏ SQL:

```sql
-- 1. –ù–∞–π–¥–∏ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω–æ–µ –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ (–∏–ª–∏ —Å–æ–∑–¥–∞–π –µ–≥–æ)
-- 2. –°–æ–∑–¥–∞–π –æ—Ç–∑—ã–≤
INSERT INTO reviews (booking_id, master_id, service_id, user_id, rating, comment, is_moderated)
SELECT 
  b.id,
  b.master_id,
  b.service_id,
  b.user_id,
  5,
  '–û—Ç–ª–∏—á–Ω—ã–π –º–∞—Å—Ç–µ—Ä, –æ—á–µ–Ω—å –¥–æ–≤–æ–ª–µ–Ω —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–º!',
  true
FROM bookings b
WHERE b.status = 'completed'
LIMIT 1;

-- 3. –î–æ–±–∞–≤—å –æ—Ç–≤–µ—Ç –Ω–∞ –æ—Ç–∑—ã–≤ (–∫–∞–∫ –∞–¥–º–∏–Ω)
UPDATE reviews
SET reply = '–°–ø–∞—Å–∏–±–æ –∑–∞ –æ—Ç–∑—ã–≤! –ú—ã —Ä–∞–¥—ã, —á—Ç–æ –≤–∞–º –ø–æ–Ω—Ä–∞–≤–∏–ª–æ—Å—å.',
    reply_by = (SELECT id FROM users WHERE role = 'admin' LIMIT 1),
    reply_at = NOW()
WHERE id = (SELECT MAX(id) FROM reviews);

-- 4. –î–æ–±–∞–≤—å –æ—Ü–µ–Ω–∫–∏ –ø–æ–ª–µ–∑–Ω–æ—Å—Ç–∏ (–æ—Ç –¥—Ä—É–≥–∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π)
INSERT INTO review_helpful (review_id, user_id, is_helpful)
SELECT 
  r.id,
  u.id,
  true
FROM reviews r
CROSS JOIN users u
WHERE r.is_moderated = true
  AND u.id != r.user_id
  AND u.role = 'user'
LIMIT 3;
```

---

### –°–ø–æ—Å–æ–± 3: –ß–µ—Ä–µ–∑ API (–¥–ª—è —Ä–∞–∑—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)

```bash
# 1. –í–æ–π–¥–∏ –∫–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∏ –ø–æ–ª—É—á–∏ —Ç–æ–∫–µ–Ω
TOKEN=$(curl -X POST https://booking-pro-api.onrender.com/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"user@example.com","password":"password123"}' \
  | jq -r '.token')

# 2. –°–æ–∑–¥–∞–π –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
BOOKING_ID=$(curl -X POST https://booking-pro-api.onrender.com/api/bookings \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"serviceId":1,"masterId":1,"date":"2024-12-25","time":"10:00"}' \
  | jq -r '.id')

# 3. –ê–¥–º–∏–Ω –∑–∞–≤–µ—Ä—à–∞–µ—Ç –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ
ADMIN_TOKEN=$(curl -X POST https://booking-pro-api.onrender.com/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"email":"admin@example.com","password":"admin123456"}' \
  | jq -r '.token')

curl -X PUT https://booking-pro-api.onrender.com/api/bookings/$BOOKING_ID/status \
  -H "Authorization: Bearer $ADMIN_TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"status":"completed"}'

# 4. –°–æ–∑–¥–∞–π –æ—Ç–∑—ã–≤
curl -X POST https://booking-pro-api.onrender.com/api/reviews \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "bookingId": '$BOOKING_ID',
    "rating": 5,
    "comment": "–û—Ç–ª–∏—á–Ω—ã–π –º–∞—Å—Ç–µ—Ä!"
  }'
```

---

## ‚úÖ –ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–∑—ã–≤–æ–≤ —É–≤–∏–¥–∏—à—å:

1. **–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/reviews`:**
   - –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å "–ú–æ–∏ –æ—Ç–∑—ã–≤—ã" / "–í—Å–µ –æ—Ç–∑—ã–≤—ã" —Å —á–∏—Å–ª–∞–º–∏
   - –§–∏–ª—å—Ç—Ä—ã –∏ —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∞ (–≤ —Ä–∞–∑–¥–µ–ª–µ "–í—Å–µ –æ—Ç–∑—ã–≤—ã")
   - –ö–Ω–æ–ø–∫–∏ üëç/üëé –ø–æ–¥ –æ—Ç–∑—ã–≤–∞–º–∏ (–≤ —Ä–∞–∑–¥–µ–ª–µ "–í—Å–µ –æ—Ç–∑—ã–≤—ã")
   - –û—Ç–≤–µ—Ç—ã –Ω–∞ –æ—Ç–∑—ã–≤—ã (—Å–∏–Ω–∏–π –±–ª–æ–∫)

2. **–ù–∞ —Å—Ç—Ä–∞–Ω–∏—Ü–µ `/masters`:**
   - –ì—Ä–∞—Ñ–∏–∫ —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Ä–µ–π—Ç–∏–Ω–≥–æ–≤
   - –û—Ç–≤–µ—Ç—ã –Ω–∞ –æ—Ç–∑—ã–≤—ã –≤ –º–æ–¥–∞–ª—å–Ω–æ–º –æ–∫–Ω–µ

3. **–í –∞–¥–º–∏–Ω-–ø–∞–Ω–µ–ª–∏ `/admin/reviews`:**
   - –í—Å–µ –æ—Ç–∑—ã–≤—ã
   - –ö–Ω–æ–ø–∫–∞ "–û—Ç–≤–µ—Ç–∏—Ç—å –Ω–∞ –æ—Ç–∑—ã–≤"

---

## üéØ –ë—ã—Å—Ç—Ä—ã–π —Ç–µ—Å—Ç (5 –º–∏–Ω—É—Ç):

1. –°–æ–∑–¥–∞–π –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ ‚Üí `/bookings`
2. –ê–¥–º–∏–Ω –∑–∞–≤–µ—Ä—à–∞–µ—Ç ‚Üí `/admin/bookings` ‚Üí —Å—Ç–∞—Ç—É—Å `completed`
3. –û—Å—Ç–∞–≤—å –æ—Ç–∑—ã–≤ ‚Üí `/reviews`
4. –ü–µ—Ä–µ–∫–ª—é—á–∏—Å—å –Ω–∞ "–í—Å–µ –æ—Ç–∑—ã–≤—ã"
5. –£–≤–∏–¥–∏—à—å –≤—Å–µ –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏! üéâ

---

**–ü–æ—Å–ª–µ —Å–æ–∑–¥–∞–Ω–∏—è –æ—Ç–∑—ã–≤–æ–≤ –≤—Å–µ –Ω–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Å—Ç–∞–Ω—É—Ç –≤–∏–¥–Ω—ã!** ‚ú®

